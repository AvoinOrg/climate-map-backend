FROM node:14.9

ARG NODE_ENV="development"
ENV NODE_ENV=${NODE_ENV}

ARG NODE_PORT=8080
ENV NODE_PORT=${NODE_PORT}

ARG POSTGRES_HOST="localhost"
ENV POSTGRES_PORT=${POSTGRES_PORT}

ARG POSTGRES_USER="test"
ENV POSTGRES_USER=${POSTGRES_USER}

ARG POSTGRES_PASSWORD="1234"
ENV POSTGRES_PASSWORD=${POSTGRES_PASSWORD}

ARG POSTGRES_DB="test_db"
ENV POSTGRES_DB=${POSTGRES_DB}

ARG POSTGRES_PORT=5433
ENV POSTGRES_PORT=${POSTGRES_PORT}

ARG JWT_SECRET="very_secret"
ENV JWT_SECRET=${JWT_SECRET}

WORKDIR /app

COPY package*.json ./
COPY docker-entrypoint.sh ./

RUN npm install

EXPOSE 8080

ENTRYPOINT ["/bin/bash", "/app/docker-entrypoint.sh"]

